---
title: js复习手记六
date: 2018-04-19 18:40:27
tags:
---

## 闭包的理解

闭包是指有权访问另一个函数的作用域中变量的函数，创建闭包最常见的方式就是在函数中创建并返回另一个函数，通过创建的这个闭包函数访问外层的局部变量，利用闭包可以突破作用域链，将变量缓存起来，说白了闭包就是外部想访问一个函数内部参数或变量的桥梁。

##### 闭包的特性：

- 函数中嵌套函数

- 闭包函数可以访问外层作用域的参数和变量 （沿着作用域链寻找）

- 闭包内的参数和变量不会被垃圾回收机制回收

- 封装变量，类似其他语言的私有变量，来限制变量的作用域

##### 闭包的优缺

- 创建是为了访问私有方法和变量。可以避免全局变量污染

- 但是闭包会保存在内存中，会增大内存的占有率，使用不当容易造成内存泄漏，

- 在js中，函数就是闭包，只有函数才能产生作用域的概念

- 闭包和循环如果同时使用的话有时会有问题，因为闭包内的变量是保存变化的，如果创建闭包之后再使用函数的话，循环里的 i 可能会一直是最后一个值（比如最大值）。


## js作用域

`全局作用域`:

在js中，最外层定义的变量拥有全局作用域，对任何内容来说，都是可以访问的。

```js
var a = 'js';
function b(){
    console.log(a)
}

b(); // js
```

`局部作用域`:

局部作用域在函数内部定义的变量，一般只有在当前作用域内下可以访问，而对于函数外部是不可以访问的，但是函数内部定义变量一定要写var命令，不然等同于生成了全局作用域。

```js

function a(){
    var b = 'js'
}
a()
console.log(b) // ReferenceError: b is not defined


function a(){
    b = 'js'
}
a()
console.log(b) // js
```

- javascript的作用域是相对函数而言的，可以称为函数作用域

- 所以并不是用var声明的变量作用范围起止于花括号之间，javascript并没有块级作用域


## js作用域链

作用域链就是在内部函数中，可以访问外部函数变量的这种机制，用链式查找决定那些数据能被内部函数访问。

当代码在一个环境中执行时，都会生成一个作用域链。作用域链的用途是保证对执行环境有权访问的所有变量和函数的有序访问。

整个作用域链是由不同执行位置上的变量对象按照规则所构建一个链表。作用域链的最前端，始终是当前正在执行的代码所在环境的变量对象。

作用域链中的下一个变量对象来自该函数的包含环境，而再下一个变量对象来自再下一个包含环境。这样，一直延续到全局执行环境，全局执行环境的Variable Object始终是作用域链中的最后一个对象。

![123](http://files.jb51.net/file_images/article/201605/201655141623615.png?201645141635)